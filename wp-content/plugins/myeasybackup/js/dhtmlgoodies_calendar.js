//alert('calendar');
/************************************************************************************************************
JS Calendar
Copyright (C) September 2006  DTHMLGoodies.com, Alf Magne Kalleland

This library is free software; you can redistribute it and/or
modify it under the terms of the GNU Lesser General Public
License as published by the Free Software Foundation; either
version 2.1 of the License, or (at your option) any later version.

This library is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
Lesser General Public License for more details.

You should have received a copy of the GNU Lesser General Public
License along with this library; if not, write to the Free Software
Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA

Dhtmlgoodies.com., hereby disclaims all copyright interest in this script
written by Alf Magne Kalleland.

Alf Magne Kalleland, 2006
Owner of DHTMLgoodies.com

************************************************************************************************************//* Update log:
(C) www.dhtmlgoodies.com, September 2005

Version 1.2, November 8th - 2005 - Added <iframe> background in IE
Version 1.3, November 12th - 2005 - Fixed top bar position in Opera 7
Version 1.4, December 28th - 2005 - Support for Spanish and Portuguese
Version 1.5, January  18th - 2006 - Fixed problem with next-previous buttons after a month has been selected from dropdown
Version 1.6, February 22nd - 2006 - Added variable which holds the path to images.
									Format todays date at the bottom by use of the todayStringFormat variable
									Pick todays date by clicking on todays date at the bottom of the calendar
Version 2.0	 May, 25th - 2006	  - Added support for time(hour and minutes) and changing year and hour when holding mouse over + and - options. (i.e. instead of click)
Version 2.1	 July, 2nd - 2006	  - Added support for more date formats(example: d.m.yyyy, i.e. one letter day and month).

// Modifications by Gregg Buntin
Version 2.1.1 8/9/2007  gfb   - Add switch to turn off Year Span Selection
                                This allows me to only have this year & next year in the drop down

Version 2.1.2 8/30/2007 gfb  - Add switch to start week on Sunday
                               Add switch to turn off week number display
                               Fix bug when using on an HTTPS page

*/function EIS_FIX_EI1(a){if(!iframeObj2)return;iframeObj2.style.display="block";iframeObj2.style.height=document.getElementById(a).offsetHeight+1;iframeObj2.style.width=document.getElementById(a).offsetWidth;iframeObj2.style.left=getleftPos(document.getElementById(a))+1-calendar_offsetLeft;iframeObj2.style.top=getTopPos(document.getElementById(a))-document.getElementById(a).offsetHeight-calendar_offsetTop}function EIS_Hide_Frame(){iframeObj2&&(iframeObj2.style.display="none")}function cancelCalendarEvent(){return!1}function isLeapYear(a){return a%400==0||a%4==0&&a%100!=0?!0:!1}function highlightMonthYear(){activeSelectBoxMonth&&(activeSelectBoxMonth.className="");activeSelectBox=this;if(this.className=="monthYearActive")this.className="";else{this.className="monthYearActive";activeSelectBoxMonth=this}if(this.innerHTML.indexOf("-")>=0||this.innerHTML.indexOf("+")>=0){this.className=="monthYearActive"?selectBoxMovementInProgress=!0:selectBoxMovementInProgress=!1;this.innerHTML.indexOf("-")>=0?activeSelectBoxDirection=-1:activeSelectBoxDirection=1}else selectBoxMovementInProgress=!1}function showMonthDropDown(){if(document.getElementById("monthDropDown").style.display=="block"){document.getElementById("monthDropDown").style.display="none";EIS_Hide_Frame()}else{document.getElementById("monthDropDown").style.display="block";document.getElementById("yearDropDown").style.display="none";document.getElementById("hourDropDown").style.display="none";document.getElementById("minuteDropDown").style.display="none";MSIE&&EIS_FIX_EI1("monthDropDown")}}function showYearDropDown(){if(document.getElementById("yearDropDown").style.display=="block"){document.getElementById("yearDropDown").style.display="none";EIS_Hide_Frame()}else{document.getElementById("yearDropDown").style.display="block";document.getElementById("monthDropDown").style.display="none";document.getElementById("hourDropDown").style.display="none";document.getElementById("minuteDropDown").style.display="none";MSIE&&EIS_FIX_EI1("yearDropDown")}}function showHourDropDown(){if(document.getElementById("hourDropDown").style.display=="block"){document.getElementById("hourDropDown").style.display="none";EIS_Hide_Frame()}else{document.getElementById("hourDropDown").style.display="block";document.getElementById("monthDropDown").style.display="none";document.getElementById("yearDropDown").style.display="none";document.getElementById("minuteDropDown").style.display="none";MSIE&&EIS_FIX_EI1("hourDropDown")}}function showMinuteDropDown(){if(document.getElementById("minuteDropDown").style.display=="block"){document.getElementById("minuteDropDown").style.display="none";EIS_Hide_Frame()}else{document.getElementById("minuteDropDown").style.display="block";document.getElementById("monthDropDown").style.display="none";document.getElementById("yearDropDown").style.display="none";document.getElementById("hourDropDown").style.display="none";MSIE&&EIS_FIX_EI1("minuteDropDown")}}function selectMonth(){document.getElementById("calendar_month_txt").innerHTML=this.innerHTML;currentMonth=this.id.replace(/[^\d]/g,"");document.getElementById("monthDropDown").style.display="none";EIS_Hide_Frame();for(var a=0;a<monthArray.length;a++)document.getElementById("monthDiv_"+a).style.color="";this.style.color=selectBoxHighlightColor;activeSelectBoxMonth=this;writeCalendarContent()}function selectHour(){document.getElementById("calendar_hour_txt").innerHTML=this.innerHTML;currentHour=this.innerHTML.replace(/[^\d]/g,"");document.getElementById("hourDropDown").style.display="none";EIS_Hide_Frame();activeSelectBoxHour&&(activeSelectBoxHour.style.color="");activeSelectBoxHour=this;this.style.color=selectBoxHighlightColor}function selectMinute(){document.getElementById("calendar_minute_txt").innerHTML=this.innerHTML;currentMinute=this.innerHTML.replace(/[^\d]/g,"");document.getElementById("minuteDropDown").style.display="none";EIS_Hide_Frame();activeSelectBoxMinute&&(activeSelectBoxMinute.style.color="");activeSelectBoxMinute=this;this.style.color=selectBoxHighlightColor}function selectYear(){document.getElementById("calendar_year_txt").innerHTML=this.innerHTML;currentYear=this.innerHTML.replace(/[^\d]/g,"");document.getElementById("yearDropDown").style.display="none";EIS_Hide_Frame();activeSelectBoxYear&&(activeSelectBoxYear.style.color="");activeSelectBoxYear=this;this.style.color=selectBoxHighlightColor;writeCalendarContent()}function switchMonth(){if(this.src.indexOf("left")>=0){currentMonth-=1;if(currentMonth<0){currentMonth=11;currentYear-=1}}else{currentMonth+=1;if(currentMonth>11){currentMonth=0;currentYear=currentYear/1+1}}writeCalendarContent()}function createMonthDiv(){var a=document.createElement("DIV");a.className="monthYearPicker";a.id="monthPicker";for(var b=0;b<monthArray.length;b++){var c=document.createElement("DIV");c.innerHTML=monthArray[b];c.onmouseover=highlightMonthYear;c.onmouseout=highlightMonthYear;c.onclick=selectMonth;c.id="monthDiv_"+b;c.style.width="56px";c.onselectstart=cancelCalendarEvent;a.appendChild(c);if(currentMonth&&currentMonth==b){c.style.color=selectBoxHighlightColor;activeSelectBoxMonth=c}}return a}function changeSelectBoxYear(a,b){b||(b=this);var c=b.parentNode.getElementsByTagName("DIV");if(b.innerHTML.indexOf("-")>=0){var d=c[1].innerHTML/1-1;activeSelectBoxYear&&(activeSelectBoxYear.style.color="")}else{var d=c[1].innerHTML/1+1;activeSelectBoxYear&&(activeSelectBoxYear.style.color="")}for(var e=1;e<c.length-1;e++){c[e].innerHTML=d+e-1;c[e].id="yearDiv"+(d/1+e/1-1)}if(activeSelectBoxYear){activeSelectBoxYear.style.color="";if(document.getElementById("yearDiv"+currentYear)){activeSelectBoxYear=document.getElementById("yearDiv"+currentYear);activeSelectBoxYear.style.color=selectBoxHighlightColor}}}function changeSelectBoxHour(a,b){b||(b=this);var c=b.parentNode.getElementsByTagName("DIV");if(b.innerHTML.indexOf("-")>=0){var d=c[1].innerHTML/1-1;d<0&&(d=0);activeSelectBoxHour&&(activeSelectBoxHour.style.color="")}else{var d=c[1].innerHTML/1+1;d>14&&(d=14);activeSelectBoxHour&&(activeSelectBoxHour.style.color="")}var e="";for(var f=1;f<c.length-1;f++){d/1+f/1<11?e="0":e="";c[f].innerHTML=e+(d+f-1);c[f].id="hourDiv"+(d/1+f/1-1)}if(activeSelectBoxHour){activeSelectBoxHour.style.color="";if(document.getElementById("hourDiv"+currentHour)){activeSelectBoxHour=document.getElementById("hourDiv"+currentHour);activeSelectBoxHour.style.color=selectBoxHighlightColor}}}function updateYearDiv(){var a=5;turnOffYearSpan&&(a=0);var b=document.getElementById("yearDropDown"),c=b.getElementsByTagName("DIV");for(var d=1;d<c.length-1;d++){c[d].innerHTML=currentYear/1-a+d;if(currentYear==currentYear/1-a+d){c[d].style.color=selectBoxHighlightColor;activeSelectBoxYear=c[d]}else c[d].style.color=""}}function updateMonthDiv(){for(no=0;no<12;no++)document.getElementById("monthDiv_"+no).style.color="";document.getElementById("monthDiv_"+currentMonth).style.color=selectBoxHighlightColor;activeSelectBoxMonth=document.getElementById("monthDiv_"+currentMonth)}function updateHourDiv(){var a=document.getElementById("hourDropDown"),b=a.getElementsByTagName("DIV"),c=0;currentHour/1-6+1<0&&(c=(currentHour/1-6+1)*-1);for(var d=1;d<b.length-1;d++){var e="";currentHour/1-6+d+c<10&&(e="0");b[d].innerHTML=e+(currentHour/1-6+d+c);if(currentHour==currentHour/1-6+d){b[d].style.color=selectBoxHighlightColor;activeSelectBoxHour=b[d]}else b[d].style.color=""}}function updateMinuteDiv(){for(no=0;no<60;no+=intervalSelectBox_minutes){var a="";no<10&&(a="0");document.getElementById("minuteDiv_"+a+no).style.color=""}if(document.getElementById("minuteDiv_"+currentMinute)){document.getElementById("minuteDiv_"+currentMinute).style.color=selectBoxHighlightColor;activeSelectBoxMinute=document.getElementById("minuteDiv_"+currentMinute)}}function createYearDiv(){if(!document.getElementById("yearDropDown")){var a=document.createElement("DIV");a.className="monthYearPicker"}else{var a=document.getElementById("yearDropDown"),b=a.getElementsByTagName("DIV");for(var c=0;c<b.length;c++)b[c].parentNode.removeChild(b[c])}var d=new Date;currentYear&&d.setFullYear(currentYear);var e=d.getFullYear()/1-5,f=10;if(!turnOffYearSpan){var g=document.createElement("DIV");g.innerHTML="&nbsp;&nbsp;- ";g.onclick=changeSelectBoxYear;g.onmouseover=highlightMonthYear;g.onmouseout=function(){selectBoxMovementInProgress=!1};g.onselectstart=cancelCalendarEvent;a.appendChild(g)}else{e=d.getFullYear()/1-0;f=2}for(var c=e;c<e+f;c++){var g=document.createElement("DIV");g.innerHTML=c;g.onmouseover=highlightMonthYear;g.onmouseout=highlightMonthYear;g.onclick=selectYear;g.id="yearDiv"+c;g.onselectstart=cancelCalendarEvent;a.appendChild(g);if(currentYear&&currentYear==c){g.style.color=selectBoxHighlightColor;activeSelectBoxYear=g}}if(!turnOffYearSpan){var g=document.createElement("DIV");g.innerHTML="&nbsp;&nbsp;+ ";g.onclick=changeSelectBoxYear;g.onmouseover=highlightMonthYear;g.onmouseout=function(){selectBoxMovementInProgress=!1};g.onselectstart=cancelCalendarEvent;a.appendChild(g)}return a}function slideCalendarSelectBox(){if(selectBoxMovementInProgress){activeSelectBox.parentNode.id=="hourDropDown"&&changeSelectBoxHour(!1,activeSelectBox);activeSelectBox.parentNode.id=="yearDropDown"&&changeSelectBoxYear(!1,activeSelectBox)}setTimeout("slideCalendarSelectBox()",speedOfSelectBoxSliding)}function createHourDiv(){if(!document.getElementById("hourDropDown")){var a=document.createElement("DIV");a.className="monthYearPicker"}else{var a=document.getElementById("hourDropDown"),b=a.getElementsByTagName("DIV");for(var c=0;c<b.length;c++)b[c].parentNode.removeChild(b[c])}currentHour||(currentHour=0);var d=currentHour/1;d>14&&(d=14);var e=document.createElement("DIV");e.innerHTML="&nbsp;&nbsp;- ";e.onclick=changeSelectBoxHour;e.onmouseover=highlightMonthYear;e.onmouseout=function(){selectBoxMovementInProgress=!1};e.onselectstart=cancelCalendarEvent;a.appendChild(e);for(var c=d;c<d+10;c++){var f="";c/1<10&&(f="0");var e=document.createElement("DIV");e.innerHTML=f+c;e.onmouseover=highlightMonthYear;e.onmouseout=highlightMonthYear;e.onclick=selectHour;e.id="hourDiv"+c;e.onselectstart=cancelCalendarEvent;a.appendChild(e);if(currentYear&&currentYear==c){e.style.color=selectBoxHighlightColor;activeSelectBoxYear=e}}var e=document.createElement("DIV");e.innerHTML="&nbsp;&nbsp;+ ";e.onclick=changeSelectBoxHour;e.onmouseover=highlightMonthYear;e.onmouseout=function(){selectBoxMovementInProgress=!1};e.onselectstart=cancelCalendarEvent;a.appendChild(e);return a}function createMinuteDiv(){if(!document.getElementById("minuteDropDown")){var a=document.createElement("DIV");a.className="monthYearPicker"}else{var a=document.getElementById("minuteDropDown"),b=a.getElementsByTagName("DIV");for(var c=0;c<b.length;c++)b[c].parentNode.removeChild(b[c])}var d=0,e="";for(var c=d;c<60;c+=intervalSelectBox_minutes){c<10?e="0":e="";var f=document.createElement("DIV");f.innerHTML=e+c;f.onmouseover=highlightMonthYear;f.onmouseout=highlightMonthYear;f.onclick=selectMinute;f.id="minuteDiv_"+e+c;f.onselectstart=cancelCalendarEvent;a.appendChild(f);if(currentYear&&currentYear==c){f.style.color=selectBoxHighlightColor;activeSelectBoxYear=f}}return a}function highlightSelect(){if(this.className=="selectBoxTime"){this.className="selectBoxTimeOver";this.getElementsByTagName("IMG")[0].src=dhtmlCalendarPathToImages+"down_time_over."+dhtmlCalendarImagesExtension}else if(this.className=="selectBoxTimeOver"){this.className="selectBoxTime";this.getElementsByTagName("IMG")[0].src=dhtmlCalendarPathToImages+"down_time."+dhtmlCalendarImagesExtension}if(this.className=="selectBox"){this.className="selectBoxOver";this.getElementsByTagName("IMG")[0].src=dhtmlCalendarPathToImages+"down_over."+dhtmlCalendarImagesExtension}else if(this.className=="selectBoxOver"){this.className="selectBox";this.getElementsByTagName("IMG")[0].src=dhtmlCalendarPathToImages+"down."+dhtmlCalendarImagesExtension}}function highlightArrow(){if(this.src.indexOf("over")>=0){this.src.indexOf("left")>=0&&(this.src=dhtmlCalendarPathToImages+"left."+dhtmlCalendarImagesExtension);this.src.indexOf("right")>=0&&(this.src=dhtmlCalendarPathToImages+"right."+dhtmlCalendarImagesExtension)}else{this.src.indexOf("left")>=0&&(this.src=dhtmlCalendarPathToImages+"left_over."+dhtmlCalendarImagesExtension);this.src.indexOf("right")>=0&&(this.src=dhtmlCalendarPathToImages+"right_over."+dhtmlCalendarImagesExtension)}}function highlightClose(){this.src.indexOf("over")>=0?this.src=dhtmlCalendarPathToImages+"close."+dhtmlCalendarImagesExtension:this.src=dhtmlCalendarPathToImages+"close_over."+dhtmlCalendarImagesExtension}function closeCalendar(){document.getElementById("yearDropDown").style.display="none";document.getElementById("monthDropDown").style.display="none";document.getElementById("hourDropDown").style.display="none";document.getElementById("minuteDropDown").style.display="none";calendarDiv.style.display="none";if(iframeObj){iframeObj.style.display="none";EIS_Hide_Frame()}activeSelectBoxMonth&&(activeSelectBoxMonth.className="");activeSelectBoxYear&&(activeSelectBoxYear.className="")}function writeTopBar(){var a=document.createElement("DIV");a.className="topBar";a.id="topBar";calendarDiv.appendChild(a);var b=document.createElement("DIV");b.style.marginRight="1px";var c=document.createElement("IMG");c.src=dhtmlCalendarPathToImages+"left."+dhtmlCalendarImagesExtension;c.onmouseover=highlightArrow;c.onclick=switchMonth;c.onmouseout=highlightArrow;b.appendChild(c);a.appendChild(b);Opera&&(b.style.width="16px");var d=document.createElement("DIV");d.style.marginRight="1px";var c=document.createElement("IMG");c.src=dhtmlCalendarPathToImages+"right."+dhtmlCalendarImagesExtension;c.onclick=switchMonth;c.onmouseover=highlightArrow;c.onmouseout=highlightArrow;d.appendChild(c);Opera&&(d.style.width="16px");a.appendChild(d);var e=document.createElement("DIV");e.id="monthSelect";e.onmouseover=highlightSelect;e.onmouseout=highlightSelect;e.onclick=showMonthDropDown;var f=document.createElement("SPAN");f.innerHTML=monthArray[currentMonth];f.id="calendar_month_txt";e.appendChild(f);var c=document.createElement("IMG");c.src=dhtmlCalendarPathToImages+"down."+dhtmlCalendarImagesExtension;c.style.position="absolute";c.style.right="0px";e.appendChild(c);e.className="selectBox";if(Opera){c.style.cssText="float:right;position:relative";c.style.position="relative";c.style.styleFloat="right"}a.appendChild(e);var g=createMonthDiv();g.style.left="37px";g.style.top=e.offsetTop+e.offsetHeight+1+"px";g.style.width="60px";g.id="monthDropDown";calendarDiv.appendChild(g);var h=document.createElement("DIV");h.onmouseover=highlightSelect;h.onmouseout=highlightSelect;h.onclick=showYearDropDown;var f=document.createElement("SPAN");f.innerHTML=currentYear;f.id="calendar_year_txt";h.appendChild(f);a.appendChild(h);var c=document.createElement("IMG");c.src=dhtmlCalendarPathToImages+"down."+dhtmlCalendarImagesExtension;h.appendChild(c);h.className="selectBox";if(Opera){h.style.width="50px";c.style.cssText="float:right";c.style.position="relative";c.style.styleFloat="right"}var i=createYearDiv();i.style.left="113px";i.style.top=e.offsetTop+e.offsetHeight+1+"px";i.style.width="35px";i.id="yearDropDown";calendarDiv.appendChild(i);var c=document.createElement("IMG");c.src=dhtmlCalendarPathToImages+"close."+dhtmlCalendarImagesExtension;c.style.styleFloat="right";c.onmouseover=highlightClose;c.onmouseout=highlightClose;c.onclick=closeCalendar;a.appendChild(c);if(!document.all){c.style.position="absolute";c.style.right="2px"}}function writeCalendarContent(){var a=!0;if(!calendarContentDiv){calendarContentDiv=document.createElement("DIV");calendarDiv.appendChild(calendarContentDiv);a=!1}currentMonth/=1;var b=new Date;b.setFullYear(currentYear);b.setDate(1);b.setMonth(currentMonth);var c=b.getDay();if(!weekStartsOnSunday){c==0&&(c=7);c--}document.getElementById("calendar_year_txt").innerHTML=currentYear;document.getElementById("calendar_month_txt").innerHTML=monthArray[currentMonth];document.getElementById("calendar_hour_txt").innerHTML=currentHour/1>9?currentHour:"0"+currentHour;document.getElementById("calendar_minute_txt").innerHTML=currentMinute/1>9?currentMinute:"0"+currentMinute;var d=calendarContentDiv.getElementsByTagName("TABLE");d.length>0&&calendarContentDiv.removeChild(d[0]);var e=document.createElement("TABLE");e.width="100%";e.cellSpacing="0";calendarContentDiv.appendChild(e);var f=document.createElement("TBODY");e.appendChild(f);var g=f.insertRow(-1);g.className="calendar_week_row";if(showWeekNumber){var h=g.insertCell(-1);h.innerHTML=weekString;h.className="calendar_week_column";h.style.backgroundColor=selectBoxRolloverBgColor}for(var i=0;i<dayArray.length;i++){var h=g.insertCell(-1);h.innerHTML=dayArray[i]}var g=f.insertRow(-1);if(showWeekNumber){var h=g.insertCell(-1);h.className="calendar_week_column";h.style.backgroundColor=selectBoxRolloverBgColor;var j=getWeek(currentYear,currentMonth,1);h.innerHTML=j}for(var i=0;i<c;i++){var h=g.insertCell(-1);h.innerHTML="&nbsp;"}var k=c,l=daysInMonthArray[currentMonth];l==28&&isLeapYear(currentYear)&&(l=29);for(var i=1;i<=l;i++){b.setDate(i-1);if(k>0&&k%7==0){var g=f.insertRow(-1);if(showWeekNumber){var h=g.insertCell(-1);h.className="calendar_week_column";var j=getWeek(currentYear,currentMonth,i);h.innerHTML=j;h.style.backgroundColor=selectBoxRolloverBgColor}}var h=g.insertCell(-1);currentYear==inputYear&&currentMonth==inputMonth&&i==inputDay&&(h.className="activeDay");h.innerHTML=i;h.onclick=pickDate;k++}if(!document.all)if(calendarContentDiv.offsetHeight)document.getElementById("topBar").style.top=calendarContentDiv.offsetHeight+document.getElementById("timeBar").offsetHeight+document.getElementById("topBar").offsetHeight-1+"px";else{document.getElementById("topBar").style.top="";document.getElementById("topBar").style.bottom="0px"}iframeObj&&(a?setTimeout("resizeIframe()",10):setTimeout("resizeIframe()",350))}function resizeIframe(){iframeObj.style.width=calendarDiv.offsetWidth+"px";iframeObj.style.height=calendarDiv.offsetHeight+"px"}function pickTodaysDate(){var a=new Date;currentMonth=a.getMonth();currentYear=a.getFullYear();pickDate(!1,a.getDate())}function pickDate(a,b){var c=currentMonth/1+1;c<10&&(c="0"+c);var d;!b&&this?d=this.innerHTML:d=b;d/1<10&&(d="0"+d);var e=currentHour/1+"",f=currentMinute/1+"";e.length<2&&(currentHour="0"+e);f.length<2&&(currentMinute="0"+f);if(returnFormat){returnFormat=returnFormat.replace("dd",d);returnFormat=returnFormat.replace("mm",c);returnFormat=returnFormat.replace("yyyy",currentYear);returnFormat=returnFormat.replace("hh",currentHour);returnFormat=returnFormat.replace("ii",currentMinute);returnFormat=returnFormat.replace("d",d/1);returnFormat=returnFormat.replace("m",c/1);returnDateTo.value=returnFormat;try{returnDateTo.onchange()}catch(a){}}else{for(var g=0;g<returnDateToYear.options.length;g++)if(returnDateToYear.options[g].value==currentYear){returnDateToYear.selectedIndex=g;break}for(var g=0;g<returnDateToMonth.options.length;g++)if(returnDateToMonth.options[g].value==parseFloat(c)){returnDateToMonth.selectedIndex=g;break}for(var g=0;g<returnDateToDay.options.length;g++)if(returnDateToDay.options[g].value==parseFloat(d)){returnDateToDay.selectedIndex=g;break}if(calendarDisplayTime){for(var g=0;g<returnDateToHour.options.length;g++)if(returnDateToHour.options[g].value==parseFloat(currentHour)){returnDateToHour.selectedIndex=g;break}for(var g=0;g<returnDateToMinute.options.length;g++)if(returnDateToMinute.options[g].value==parseFloat(currentMinute)){returnDateToMinute.selectedIndex=g;break}}}closeCalendar()}function getWeek(a,b,c){weekStartsOnSunday?c=c/1+1:c/=1;a/=1;b=b/1+1;var d=Math.floor((14-b)/12),e=a+4800-d,f=b+12*d-3,g=c+Math.floor((153*f+2)/5)+365*e+Math.floor(e/4)-Math.floor(e/100)+Math.floor(e/400)-32045,h=(g+31741-g%7)%146097%36524%1461,i=Math.floor(h/1460),j=(h-i)%365+i;NumberOfWeek=Math.floor(j/7)+1;return NumberOfWeek}function writeTimeBar(){var a=document.createElement("DIV");a.id="timeBar";a.className="timeBar";var b=document.createElement("DIV");b.innerHTML="Time:";var c=document.createElement("DIV");c.onmouseover=highlightSelect;c.onmouseout=highlightSelect;c.onclick=showHourDropDown;c.style.width="30px";var d=document.createElement("SPAN");d.innerHTML=currentHour;d.id="calendar_hour_txt";c.appendChild(d);a.appendChild(c);var e=document.createElement("IMG");e.src=dhtmlCalendarPathToImages+"down_time."+dhtmlCalendarImagesExtension;c.appendChild(e);c.className="selectBoxTime";if(Opera){c.style.width="30px";e.style.cssText="float:right";e.style.position="relative";e.style.styleFloat="right"}var f=createHourDiv();f.style.left="130px";f.style.width="35px";f.id="hourDropDown";calendarDiv.appendChild(f);var g=document.createElement("DIV");g.onmouseover=highlightSelect;g.onmouseout=highlightSelect;g.onclick=showMinuteDropDown;g.style.width="30px";var d=document.createElement("SPAN");d.innerHTML=currentMinute;d.id="calendar_minute_txt";g.appendChild(d);a.appendChild(g);var e=document.createElement("IMG");e.src=dhtmlCalendarPathToImages+"down_time."+dhtmlCalendarImagesExtension;g.appendChild(e);g.className="selectBoxTime";if(Opera){g.style.width="30px";e.style.cssText="float:right";e.style.position="relative";e.style.styleFloat="right"}var h=createMinuteDiv();h.style.left="167px";h.style.width="35px";h.id="minuteDropDown";calendarDiv.appendChild(h);return a}function writeBottomBar(){var a=new Date,b=document.createElement("DIV");b.id="bottomBar";b.style.cursor="pointer";b.className="todaysDate";var c=document.createElement("DIV");c.onclick=pickTodaysDate;c.id="todaysDateString";c.style.width=calendarDiv.offsetWidth-95+"px";var d=a.getDay();if(!weekStartsOnSunday){d==0&&(d=7);d--}var e=todayStringFormat;e=e.replace("[monthString]",monthArray[a.getMonth()]);e=e.replace("[day]",a.getDate());e=e.replace("[year]",a.getFullYear());e=e.replace("[dayString]",dayArray[d].toLowerCase());e=e.replace("[UCFdayString]",dayArray[d]);e=e.replace("[todayString]",todayString);c.innerHTML=todayString+": "+a.getDate()+" "+monthArrayShort[a.getMonth()]+" "+a.getFullYear();c.innerHTML=e;b.appendChild(c);var f=writeTimeBar();b.appendChild(f);calendarDiv.appendChild(b)}function getTopPos(a){var b=a.offsetTop+a.offsetHeight;while((a=a.offsetParent)!=null)b+=a.offsetTop;return b+calendar_offsetTop}function getleftPos(a){var b=a.offsetLeft;while((a=a.offsetParent)!=null)b+=a.offsetLeft;return b+calendar_offsetLeft}function positionCalendar(a){calendarDiv.style.left=getleftPos(a)+"px";calendarDiv.style.top=getTopPos(a)+"px";if(iframeObj){iframeObj.style.left=calendarDiv.style.left;iframeObj.style.top=calendarDiv.style.top;iframeObj2.style.left=calendarDiv.style.left;iframeObj2.style.top=calendarDiv.style.top}}function initCalendar(){if(MSIE){iframeObj=document.createElement("IFRAME");iframeObj.style.filter="alpha(opacity=0)";iframeObj.style.position="absolute";iframeObj.border="0px";iframeObj.style.border="0px";iframeObj.style.backgroundColor="#FF0000";iframeObj2=document.createElement("IFRAME");iframeObj2.style.position="absolute";iframeObj2.border="0px";iframeObj2.style.border="0px";iframeObj2.style.height="1px";iframeObj2.style.width="1px";iframeObj2.src="blank.html";iframeObj.src="blank.html";document.body.appendChild(iframeObj2);document.body.appendChild(iframeObj)}calendarDiv=document.createElement("DIV");calendarDiv.id="calendarDiv";calendarDiv.style.zIndex=1e3;slideCalendarSelectBox();document.body.appendChild(calendarDiv);writeBottomBar();writeTopBar();if(!currentYear){var a=new Date;currentMonth=a.getMonth();currentYear=a.getFullYear()}writeCalendarContent()}function setTimeProperties(){if(!calendarDisplayTime){document.getElementById("timeBar").style.display="none";document.getElementById("timeBar").style.visibility="hidden";document.getElementById("todaysDateString").style.width="100%"}else{document.getElementById("timeBar").style.display="block";document.getElementById("timeBar").style.visibility="visible";document.getElementById("hourDropDown").style.top=document.getElementById("calendar_minute_txt").parentNode.offsetHeight+calendarContentDiv.offsetHeight+document.getElementById("topBar").offsetHeight+"px";document.getElementById("minuteDropDown").style.top=document.getElementById("calendar_minute_txt").parentNode.offsetHeight+calendarContentDiv.offsetHeight+document.getElementById("topBar").offsetHeight+"px";document.getElementById("minuteDropDown").style.right="50px";document.getElementById("hourDropDown").style.right="50px";document.getElementById("todaysDateString").style.width="115px"}}function calendarSortItems(a,b){return a/1-b/1}function displayCalendar(a,b,c,d,e){d?calendarDisplayTime=!0:calendarDisplayTime=!1;if(a.value.length>6)if(!a.value.match(/^[0-9]*?$/gi)){var f=a.value.split(/[^0-9]/gi),g=new Object;g.m=b.indexOf("mm");g.m==-1&&(g.m=b.indexOf("m"));g.d=b.indexOf("dd");g.d==-1&&(g.d=b.indexOf("d"));g.y=b.indexOf("yyyy");g.h=b.indexOf("hh");g.i=b.indexOf("ii");this.initialHour="00";this.initialMinute="00";var h=["y","m","d","h","i"],i=["currentYear","currentMonth","inputDay","currentHour","currentMinute"],j=[4,2,2,2,2];for(var k=0;k<h.length;k++)g[h[k]]>=0&&(window[i[k]]=a.value.substr(g[h[k]],j[k])/1);currentMonth--}else{var l=b.indexOf("mm");currentMonth=a.value.substr(l,2)/1-1;var m=b.indexOf("yyyy");currentYear=a.value.substr(m,4);var n=b.indexOf("dd");tmpDay=a.value.substr(n,2);var o=b.indexOf("hh");if(o>=0){tmpHour=a.value.substr(o,2);currentHour=tmpHour;currentHour.length==1&&(currentHour="0")}else currentHour="00";var p=b.indexOf("ii");if(p>=0){tmpMinute=a.value.substr(p,2);currentMinute=tmpMinute}else currentMinute="00"}else{var q=new Date;currentMonth=q.getMonth();currentYear=q.getFullYear();currentHour="08";currentMinute="00";inputDay=q.getDate()/1}inputYear=currentYear;inputMonth=currentMonth;if(!calendarDiv)initCalendar();else{if(calendarDiv.style.display=="block"){closeCalendar();return!1}writeCalendarContent()}returnFormat=b;returnDateTo=a;positionCalendar(c);calendarDiv.style.visibility="visible";calendarDiv.style.display="block";if(iframeObj){iframeObj.style.display="";iframeObj.style.height="140px";iframeObj.style.width="195px";iframeObj2.style.display="";iframeObj2.style.height="140px";iframeObj2.style.width="195px"}setTimeProperties();updateYearDiv();updateMonthDiv();updateMinuteDiv();updateHourDiv()}function displayCalendarSelectBox(a,b,c,d,e,f){d?calendarDisplayTime=!0:calendarDisplayTime=!1;currentMonth=b.options[b.selectedIndex].value/1-1;currentYear=a.options[a.selectedIndex].value;if(d){currentHour=d.options[d.selectedIndex].value;inputHour=currentHour/1}if(e){currentMinute=e.options[e.selectedIndex].value;inputMinute=currentMinute/1}inputYear=a.options[a.selectedIndex].value;inputMonth=b.options[b.selectedIndex].value/1-1;inputDay=c.options[c.selectedIndex].value/1;calendarDiv?writeCalendarContent():initCalendar();returnDateToYear=a;returnDateToMonth=b;returnDateToDay=c;returnDateToHour=d;returnDateToMinute=e;returnFormat=!1;returnDateTo=!1;positionCalendar(f);calendarDiv.style.visibility="visible";calendarDiv.style.display="block";if(iframeObj){iframeObj.style.display="";iframeObj.style.height=calendarDiv.offsetHeight+"px";iframeObj.style.width=calendarDiv.offsetWidth+"px";iframeObj2.style.display="";iframeObj2.style.height=calendarDiv.offsetHeight+"px";iframeObj2.style.width=calendarDiv.offsetWidth+"px"}setTimeProperties();updateYearDiv();updateMonthDiv();updateHourDiv();updateMinuteDiv()}var turnOffYearSpan=!1,weekStartsOnSunday=!1,showWeekNumber=!0,languageCode="en",calendar_display_time=!0,todayStringFormat="[todayString] [UCFdayString]. [day]. [monthString] [year]";if(typeof dhtmlCalendarPathToImages=="undefined")var dhtmlCalendarPathToImages="../wp-content/plugins/myeasybackup/img/calendar/",dhtmlCalendarImagesExtension="png";var speedOfSelectBoxSliding=200,intervalSelectBox_minutes=5,calendar_offsetTop=-260,calendar_offsetLeft=-260,calendarDiv=!1,MSIE=!1,Opera=!1;navigator.userAgent.indexOf("MSIE")>=0&&navigator.userAgent.indexOf("Opera")<0&&(MSIE=!0);navigator.userAgent.indexOf("Opera")>=0&&(Opera=!0);switch(languageCode){case"en":var monthArray=["January","February","March","April","May","June","July","August","September","October","November","December"],monthArrayShort=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayArray=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],weekString="Week",todayString="";break;case"it":var monthArray=["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],monthArrayShort=["Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago","Setp","Ott","Nov","Dic"],dayArray=["Lun","Mar","Mer","Gio","Ven","Sab","Dom"],weekString="Sett.",todayString="";break;case"ge":var monthArray=["Januar","Februar","M�rz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],monthArrayShort=["Jan","Feb","Mar","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],dayArray=["Mon","Die","Mit","Don","Fre","Sam","Son"],weekString="Woche",todayString="Heute";break;case"no":var monthArray=["Januar","Februar","Mars","April","Mai","Juni","Juli","August","September","Oktober","November","Desember"],monthArrayShort=["Jan","Feb","Mar","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Des"],dayArray=["Man","Tir","Ons","Tor","Fre","L&oslash;r","S&oslash;n"],weekString="Uke",todayString="Dagen i dag er";break;case"nl":var monthArray=["Januari","Februari","Maart","April","Mei","Juni","Juli","Augustus","September","Oktober","November","December"],monthArrayShort=["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],dayArray=["Ma","Di","Wo","Do","Vr","Za","Zo"],weekString="Week",todayString="Vandaag";break;case"es":var monthArray=["Enero","Febrero","Marzo","April","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],monthArrayShort=["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],dayArray=["Lun","Mar","Mie","Jue","Vie","Sab","Dom"],weekString="Semana",todayString="Hoy es";break;case"pt-br":var monthArray=["Janeiro","Fevereiro","Mar&ccedil;o","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],monthArrayShort=["Jan"
,"Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],dayArray=["Seg","Ter","Qua","Qui","Sex","S&aacute;b","Dom"],weekString="Sem.",todayString="Hoje &eacute;";break;case"fr":var monthArray=["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Aoùt","Septembre","Octobre","Novembre","Décembre"],monthArrayShort=["Jan","Fev","Mar","Avr","Mai","Jun","Jul","Aou","Sep","Oct","Nov","Dec"],dayArray=["Lun","Mar","Mer","Jeu","Ven","Sam","Dim"],weekString="Sem",todayString="Aujourd'hui";break;case"da":var monthArray=["januar","februar","marts","april","maj","juni","juli","august","september","oktober","november","december"],monthArrayShort=["jan","feb","mar","apr","maj","jun","jul","aug","sep","okt","nov","dec"],dayArray=["man","tirs","ons","tors","fre","l&oslash;r","s&oslash;n"],weekString="Uge",todayString="I dag er den";break;case"hu":var monthArray=["Január","Február","Március","�?prilis","Május","Június","Július","Augusztus","Szeptember","Október","November","December"],monthArrayShort=["Jan","Feb","Márc","�?pr","Máj","Jún","Júl","Aug","Szep","Okt","Nov","Dec"],dayArray=["Hé","Ke","Sze","Cs","Pé","Szo","Vas"],weekString="Hét",todayString="Mai nap";break;case"it":var monthArray=["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],monthArrayShort=["Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago","Set","Ott","Nov","Dic"],dayArray=["Lun",";Mar","Mer","Gio","Ven","Sab","Dom"],weekString="Settimana",todayString="Oggi &egrave; il";break;case"sv":var monthArray=["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"],monthArrayShort=["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],dayArray=["M&aring;n","Tis","Ons","Tor","Fre","L&ouml;r","S&ouml;n"],weekString="Vecka",todayString="Idag &auml;r det den";break;case"cz":var monthArray=["leden","&#250;nor","b&#345;ezen","duben","kv&#283;ten","&#269;erven","&#269;ervenec","srpen","z&#225;&#345;&#237;","&#345;&#237;jen","listopad","prosinec"],monthArrayShort=["led","&#250;n","b&#345;","dub","kv&#283;","&#269;er","&#269;er-ec","srp","z&#225;&#345;","&#345;&#237;j","list","pros"],dayArray=["Pon","&#218;t","St","&#268;t","P&#225;","So","Ne"],weekString="t&#253;den",todayString=""}if(weekStartsOnSunday){var tempDayName=dayArray[6];for(var theIx=6;theIx>0;theIx--)dayArray[theIx]=dayArray[theIx-1];dayArray[0]=tempDayName}var daysInMonthArray=[31,28,31,30,31,30,31,31,30,31,30,31],currentMonth,currentYear,currentHour,currentMinute,calendarContentDiv,returnDateTo,returnFormat,activeSelectBoxMonth,activeSelectBoxYear,activeSelectBoxHour,activeSelectBoxMinute,iframeObj=!1,iframeObj2=!1,returnDateToYear,returnDateToMonth,returnDateToDay,returnDateToHour,returnDateToMinute,inputYear,inputMonth,inputDay,inputHour,inputMinute,calendarDisplayTime=!1,selectBoxHighlightColor="#D60808",selectBoxRolloverBgColor="#E2EBED",selectBoxMovementInProgress=!1,activeSelectBox=!1,activeSelectBoxMonth=!1,activeSelectBoxDirection=!1;